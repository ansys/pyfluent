---
title: PyFluent cheat sheet
format: cheat_sheet-pdf
version: 0.1.0
footer: PyFluent
footerlinks:
  - urls: 'https://fluent.docs.pyansys.com/version/stable/'
    text: Documentation
  - urls: 'https://fluent.docs.pyansys.com/version/stable/getting_started/index.html'
    text: Getting started
  - urls: 'https://fluent.docs.pyansys.com/version/stable/examples/index.html'
    text: Examples
  - urls: 'https://fluent.docs.pyansys.com/version/stable/api/index.html'
    text: API reference
  - urls: 'https://fluent.docs.pyansys.com/version/stable/getting_started/faqs.html'
    text: FAQ
  - urls: 'https://github.com/ansys/pyfluent/discussions'
    text: Discussions
  - urls: 'https://github.com/ansys/pyfluent/issues'
    text: 'Issues'
execute:
  eval: false
jupyter:
  jupytext:
    text_representation:
      extension: .qmd
      format_name: quarto
      format_version: '1.0'
      jupytext_version: 1.16.4
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---


## Session Management

### Launch sessions

```{python}
import ansys.fluent.core as pyfluent
# Solver mode
solver = pyfluent.Solver.from_install()
# Meshing mode
meshing = pyfluent.Meshing.from_install()

# Connect to existing session
solver = pyfluent.Solver.from_connection(
    ip="127.0.0.1", port=50000, password="password",
    )
meshing = pyfluent.Meshing.from_connection(
    ip="127.0.0.1", port=50000, password="password"
    )
```

### File I/O

```{python}
from ansys.fluent.core.solver import (
    ReadCase,
    ReadCaseData,
    WriteCase,
    WriteCaseData,
)
# Read case
ReadCase(settings_source=solver)(file_name="simulation.cas.h5")
# Read case and data
ReadCaseData(settings_source=solver)(file_name="simulation.cas.h5")
# Write files
WriteCase(settings_source=solver)(file_name="output.cas.h5")
WriteCaseData(settings_source=solver)(file_name="output.cas.h5")
```

## Meshing Workflow

### Watertight geometry workflow

```{python}
wt = meshing.watertight()
# Import geometry
wt.import_geometry.file_name = "geometry.pmdb"
wt.import_geometry.length_unit = "mm"
wt.import_geometry()
# Surface mesh
wt.create_surface_mesh.cfd_surface_mesh_controls.max_size = 0.3
wt.create_surface_mesh()
# Describe geometry
wt.describe_geometry.setup_type = "fluids"
wt.describe_geometry()
# Update boundaries
wt.update_boundaries()
wt.update_regions()
# Volume mesh
wt.create_volume_mesh.volume_fill = "poly-hexcore"
wt.create_volume_mesh.volume_fill_controls.hex_max_cell_length = 0.3
wt.create_volume_mesh()
# Switch to solver
solver = meshing.switch_to_solver()
```

## Physics Setup

### Boundary conditions

```{python}
from ansys.fluent.core.solver import (
    VelocityInlet,
)
bc = solver.setup.boundary_conditions
# Velocity inlet
inlet = VelocityInlet(settings_source=solver, name="cold-inlet")
inlet.momentum.velocity = 0.4
inlet.turbulence.turbulence_specification = "Intensity and Hydraulic Diameter"
inlet.turbulence.turbulent_intensity = 0.05
inlet.turbulence.hydraulic_diameter = "4 [in]"
inlet.thermal.temperature = 293.15
```

### Materials

```{python}
# Copy and modify material
materials = solver.setup.materials
air_copy = materials.fluid.copy_database_material_by_formula("air")
air_copy.viscosity.value = 1.81e-05
# Create new material
mysolid = materials.solid.create("mysolid")
mysolid.density.value = 2650
mysolid.thermal_conductivity.value = 7.6
```

### Cell zone conditions

```{python}
cz = solver.setup.cell_zone_conditions
cz.fluid["elbow-fluid"].material = "air-2"
```

### Models

```{python}
models = solver.setup.models
# Energy
models.energy.enabled = True
models.energy.viscous_dissipation = True
# Viscous
models.viscous.model = "k-epsilon"
models.viscous.k_epsilon_model = "realizable"
# Radiation
models.radiation.model = "monte-carlo"
models.radiation.monte_carlo.number_of_histories = 1e7
# Species transport
models.species.model.option = "species-transport"
```

### Solution methods

```{python}
methods = solver.solution.methods
methods.p_v_coupling.flow_scheme = "Coupled"
methods.gradient_scheme = "green-gauss-node-based"
```

### Solution controls

```{python}
controls = solver.solution.controls
controls.p_v_controls.flow_courant_number = 0.5
```

### Report definitions

```{python}
rep_defs = solver.solution.report_definitions
surf_rep = rep_defs.surface["outlet-temp-avg"] = {}
surf_rep.report_type = "surface-massavg"
surf_rep.field = "temperature"
```

## Solution

### Initialize and solve

```{python}
# Initialization
solver.solution.initialization.hybrid_initialize()
# Run calculation
solver.solution.run_calculation.iterate(iter_count=100)
# Check convergence
solver.solution.monitor.residual.plot()
```

## Post-Processing

### Field data access

```{python}
# Ensure the session is initialized before requesting field data
# solver.solution.initialization.hybrid_initialize()

from ansys.fluent.core import (
    ScalarFieldDataRequest,
    VectorFieldDataRequest,
    SurfaceFieldDataRequest,
    PathlinesFieldDataRequest,
    SurfaceDataType,
)

field_data = solver.fields.field_data

# Scalar field data (absolute pressure on cold-inlet)
abs_press_req = ScalarFieldDataRequest(
    field_name="absolute-pressure",
    surfaces=["cold-inlet"],
)
abs_pressure = field_data.get_field_data(abs_press_req)

# Vector field data (velocity on cold-inlet)
vel_req = VectorFieldDataRequest(
    field_name="velocity",
    surfaces=["cold-inlet"],
)
velocity = field_data.get_field_data(vel_req)

# Surface data (vertices and face centroids on hot-inlet and cold-inlet)
surf_req = SurfaceFieldDataRequest(
    data_types=[SurfaceDataType.Vertices, SurfaceDataType.FacesCentroid],
    surfaces=["hot-inlet", "cold-inlet"],
)
surfaces = field_data.get_field_data(surf_req)

# Access examples
cold_vertices = surfaces["cold-inlet"].vertices
hot_centroids = surfaces["hot-inlet"].face_centroids
```

### Field info (allowed values, active status, ranges)

```{python}

# Allowed values
scalar_names = sorted(field_data.scalar_fields.allowed_values())
vector_names = sorted(field_data.vector_fields.allowed_values())
surface_names = sorted(field_data.surfaces.allowed_values())

# Active status (variable availability)
is_temp_active = field_data.scalar_fields.is_active("temperature")
is_vel_active = field_data.vector_fields.is_active("velocity")

# Value ranges (numeric range of value for given variable)
temp_range = field_data.scalar_fields.range("temperature")
vmag_range = field_data.scalar_fields.range("velocity-magnitude")
```

### Reduction functions

```{python}
reduction = solver.fields.reduction
# Area and volume
area = reduction.area(locations=["inlet"])
volume = reduction.volume(locations=["fluid"])
# Averages and integrals
avg_temp = reduction.area_average("temperature", locations=["outlet"])
total_mass = reduction.mass_integral("1", locations=["fluid"])
# Force and moment
force = reduction.force(locations=["wall"])
# Min/max
max_vel = reduction.maximum("velocity-magnitude", locations=["fluid"])
```

### Solution variables

```{python}
sv_info = solver.fields.solution_variable_info
sv_data = solver.fields.solution_variable_data
# Get zone info
zones_info = sv_info.get_zones_info()
# Get variable data
temp_data = sv_data.get_data(
    variable_name="SV_T",
    zone_names=["fluid"], 
    domain_name="mixture"
)
# Set variable data
temp_array = sv_data.create_empty_array("SV_T", "fluid", "mixture")
temp_array[:] = 500
sv_data.set_data(
    variable_name="SV_T",
    zone_names_to_data={'fluid': temp_array},
    domain_name="mixture"
)
```

## PyAnsys Units

```{python}
from ansys.units import Quantity as Q
inlet = solver.setup.boundary_conditions.velocity_inlet["hot-inlet"]
inlet.turbulence.hydraulic_diameter = Q(15, "mm")
diam = inlet.turbulence.hydraulic_diameter.as_quantity()
# Unit conversion
diam_in_inches = diam.to("in")
```

## Variable descriptors

```{python}
# Access allowed values and ranges
turb_spec = inlet.turbulence.turbulence_specification
turb_spec.allowed_values()
intensity = inlet.turbulence.turbulent_intensity
intensity.min(), intensity.max()
```





