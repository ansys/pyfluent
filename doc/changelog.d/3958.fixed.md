Update reduction test and re-implement it.