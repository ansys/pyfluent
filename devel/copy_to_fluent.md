#### Steps to commit PyFluent sources to Fluent repository:

Fluent's Python console consumes the Pyfluent sources which are committed and packaged with Fluent. If you want to make a recent PyFluent feature available in Fluent's Python Console, you need to commit the PyFluent sources to the Fluent repository. Following are the steps to do that. We need update these instructions in the future when we include more pyfluent-related libraries like visualization.

1. Checkout to the develop branch in Fluent and pull the latest changes. It is recommended to always use the latest develop branch in Fluent as we will generate and commit the Fluent API files. Build Fluent as we will run codegen.

2. Make sure the PyFluent feature is reviewed and merged in the PyFluent main branch.

3. Checkout to the main branch in PyFluent and pull the latest changes. Set the environment variable `PYFLUENT_CODEGEN_ZIP_SETTINGS` to `1` and run codegen against the latest Fluent develop branch.

4. Create a Python virtual environment with Python from FBU_Dependencies.

    ```shell
    %FBU_Dependencies%\commonfiles\CPython\3_10\winx64\Release\python\python.exe -m venv <environment name> --system-site-packages
    ```

5. Activate the virtual environment and run the following command from PyFluent root directory to install the PyFluent package in the virtual environment.

    ```shell
    pip install .
    ```

6. Run the script `devel\scripts\copy_to_fluent.py`. You need to pass the site-packages path inside the above virtual environment and the Fluent git directory path as arguments to the script. The script will copy the PyFluent sources to the Fluent repository and print the Fluent Manifest code.

    ```shell
    >python devel\scripts\copy_to_fluent.py -h
    usage: copy_to_fluent.py [-h] --pyfluent-path PYFLUENT_PATH --fluent-path FLUENT_PATH

    Copy Pyfluent files to Fluent and print Fluent Manifest

    options:
    -h, --help            show this help message and exit
    --pyfluent-path PYFLUENT_PATH
                            Path to site-packages directory containing pyfluent
    --fluent-path FLUENT_PATH
                            Path to Fluent git repository

    >python devel\scripts\copy_to_fluent.py --pyfluent-path <site-packages containing PyFluent> --fluent-path <Fluent git directory>
    ```

7. Copy the Fluent Manifest code printed by the above script and replace it in the `packageManifest/cortex/manifest.pkg` file in the Fluent repository between the following comments:

    ```text
    # PyFluent sources START
    <manifest code>
    # PyFluent sources END
    ```

8. Add the directory <fluent root>\cortex\pylib\pyfluent\ansys\fluent\core to the Fluent repository using the following command.

    ```shell
    git add <fluent root>\cortex\pylib\pyfluent\ansys\fluent\core -f
    ```

9. Commit the changes. Mention the PyFluent git short hash, generated by the following command, in the commit message and the PR title.

    ```shell
    git rev-parse --short HEAD
    ```

10. It is recommended to run the custom regression `flcore_pyconsole.py` with the Fluent branch before merging it to the main branch.
